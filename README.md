# S.A.B.A.T - Semi-Automatic BLAST Annotation Toolkit

SABAT is toolkit for identifying gene homologs in other species using a gene coding sequence (CDS) and BLAST.

Analysis is perfomed in 5 steps as follows:
1. BLAST your gene CDS against a genome of interest. (blastn/dc-megablast)
2. Convert the BLAST output to a BED file. (SABAT blast2bed)
3. Visualise your BED file (BLAST results) with the genome of interest. (IGV)
4. Select exons that make up your genes.
5. Reconstruct the homelogs CDS and protein sequence. (SABAT assemble-gene)

# Installation

TBA

# Commands

## blast2bed

### parameters
|Parameter|Description|
|---|---|
| -i, --input | BLAST ouput in tabular format (outfmt6) |
| -e, --exons | Expected number of exon in the gene. Default: 1 |
| -c, --coverage | A float that roportion of gene CDS that must be covered by BLAST hits for a locus to be defined (0.0-1.0). Default: 1.1 |
| -l, --locus_size | Expected size of the gene locus in base pairs. Default: 1000|
| -r, --refseq | Boolean values that indicates whether the BLASTDB provided uses a refseq sequence (RefSeq headers are different from the standard headers in a BLASTDB). Default: False |

The BED file generated is directed to the stdout.

### Usage

    python3 __main__.py blast2bed \
    --input results.blastn \
    --exons 3 \
    --coverage 0.95 \
    --locus_size 5000 \
    --refseq False \
    > output.bed

## assemble-gene

### Parameters
|Parameter |Description |
|---|---|
| -i, --input | Path to a Bed file (generated by blast2bed)|
| -db, --database | Path to BLASTDB used to generate the blast output used by blast2bed|
| -e, --exons | Path to a txt file containing the gene exons, in order, with 1 exon per line |

### Usage

Dummy exon file:

        exon_1
        exon_2
        exon_3

Command:

    python3 __main__.py assemble-gene \
    -i output.bed
    -db path/to/blast/db/
    -e exons.txt
    > genes.fasta


### Roadmap

- stderr logging for all commands
- ordered stdout for assemble-gene
- edit and unedited outputs for assemble-gene (will need to output results as file rather than to std out)
